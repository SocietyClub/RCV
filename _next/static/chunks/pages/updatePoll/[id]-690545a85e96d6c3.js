(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[122],{6818:function(e,t,n){"use strict";var a=n(4836);t.Z=void 0;var i=a(n(4938)),s=n(5893),r=(0,i.default)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.Z=r},754:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var a=n(3366),i=n(7462),s=n(7294),r=n(6010),o=n(4780),c=n(917),l=n(6622),d=n(5959),u=n(7074),f=n(4867);function h(e){return(0,f.Z)("MuiCircularProgress",e)}(0,n(1588).Z)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var m=n(5893);const v=["className","color","disableShrink","size","style","thickness","value","variant"];let p,g,x,C,j=e=>e;const S=44,y=(0,c.F4)(p||(p=j`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),Z=(0,c.F4)(g||(g=j`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),k=(0,u.ZP)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${(0,l.Z)(n.color)}`]]}})((({ownerState:e,theme:t})=>(0,i.Z)({display:"inline-block"},"determinate"===e.variant&&{transition:t.transitions.create("transform")},"inherit"!==e.color&&{color:(t.vars||t).palette[e.color].main})),(({ownerState:e})=>"indeterminate"===e.variant&&(0,c.iv)(x||(x=j`
      animation: ${0} 1.4s linear infinite;
    `),y))),N=(0,u.ZP)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),P=(0,u.ZP)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${(0,l.Z)(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})((({ownerState:e,theme:t})=>(0,i.Z)({stroke:"currentColor"},"determinate"===e.variant&&{transition:t.transitions.create("stroke-dashoffset")},"indeterminate"===e.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})),(({ownerState:e})=>"indeterminate"===e.variant&&!e.disableShrink&&(0,c.iv)(C||(C=j`
      animation: ${0} 1.4s ease-in-out infinite;
    `),Z)));var _=s.forwardRef((function(e,t){const n=(0,d.Z)({props:e,name:"MuiCircularProgress"}),{className:s,color:c="primary",disableShrink:u=!1,size:f=40,style:p,thickness:g=3.6,value:x=0,variant:C="indeterminate"}=n,j=(0,a.Z)(n,v),y=(0,i.Z)({},n,{color:c,disableShrink:u,size:f,thickness:g,value:x,variant:C}),Z=(e=>{const{classes:t,variant:n,color:a,disableShrink:i}=e,s={root:["root",n,`color${(0,l.Z)(a)}`],svg:["svg"],circle:["circle",`circle${(0,l.Z)(n)}`,i&&"circleDisableShrink"]};return(0,o.Z)(s,h,t)})(y),_={},L={},w={};if("determinate"===C){const e=2*Math.PI*((S-g)/2);_.strokeDasharray=e.toFixed(3),w["aria-valuenow"]=Math.round(x),_.strokeDashoffset=`${((100-x)/100*e).toFixed(3)}px`,L.transform="rotate(-90deg)"}return(0,m.jsx)(k,(0,i.Z)({className:(0,r.Z)(Z.root,s),style:(0,i.Z)({width:f,height:f},L,p),ownerState:y,ref:t,role:"progressbar"},w,j,{children:(0,m.jsx)(N,{className:Z.svg,ownerState:y,viewBox:"22 22 44 44",children:(0,m.jsx)(P,{className:Z.circle,style:_,ownerState:y,cx:S,cy:S,r:(S-g)/2,fill:"none",strokeWidth:g})})}))}))},9127:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/updatePoll/[id]",function(){return n(526)}])},6e3:function(e,t,n){"use strict";var a=n(5893),i=n(7294),s=n(9243),r=n(2741),o=n(1973),c=n.n(o),l=function(e){var t=(0,i.useState)(!1),n=t[0],o=t[1],l=(0,i.useState)(null),d=l[0],u=l[1],f=function(){o(!1)};return(0,i.useEffect)((function(){e.alert?(u(e.alert),o(!0)):f()}),[e.alert]),(0,a.jsxs)("div",{className:c().page,children:[(0,a.jsxs)("div",{className:c().contentContainer,children:[(0,a.jsx)("div",{className:c().mainContent,children:e.children}),e.sidebar]}),(0,a.jsx)(s.Z,{open:n,onClose:f,autoHideDuration:e.autoHideAlertMilliSeconds,children:(0,a.jsxs)(r.Z,{onClose:f,severity:null===d||void 0===d?void 0:d.severity,children:[null===d||void 0===d?void 0:d.message,(null===d||void 0===d?void 0:d.errorMessages)&&d.errorMessages.map((function(e){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("br",{}),e.messageContent]})}))]})})]})};l.defaultProps={alert:null},t.Z=l},532:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var a=n(5893),i=n(7294),s=n(9630),r=n(3676),o=n(9815),c=n(562),l=n(5084),d=n(6761),u=n(6853),f=n.n(u),h=function(e){var t=(0,i.useState)(!0),n=t[0],u=t[1],h=(0,i.useCallback)((function(){var t=document.querySelectorAll("."+e.textFieldClassName+":last-of-type input")[0];t&&t.focus&&t.focus()}),[e.textFieldClassName]),m=function(t){"Enter"===t.key&&(u(!n),e.setCandidateList((0,o.Z)(e.candidateList).concat([{name:""}])))},v=function(t){var n=Number(t.target.name),a=(0,o.Z)(e.candidateList);a[n]={name:t.target.value},e.setCandidateList(a)};return(0,i.useEffect)((function(){h()}),[n,h]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{variant:"h4",children:"Candidates"}),e.candidateList.map((function(t,n){return(0,a.jsxs)("div",{style:{display:"flex"},children:[(0,a.jsx)(r.Z,{style:{flexGrow:1},name:String(n),className:e.textFieldClassName,onKeyPress:m,label:"Candidate Name",variant:"filled",value:t.name,onChange:v},n),(0,a.jsx)(c.Z,{"aria-label":"delete",onClick:function(){return function(t){e.candidateList.splice(t,1),e.setCandidateList((0,o.Z)(e.candidateList))}(n)},children:(0,a.jsx)(d.Z,{})},n)]},n)})),(0,a.jsx)(l.Z,{className:f().addCandidateButton,variant:"contained",onClick:function(){u(!n),e.setCandidateList((0,o.Z)(e.candidateList).concat([{name:""}]))},children:"Add Candidate"})]})};h.defaultProps={};var m=h,v=n(7056),p=function(e){var t=Math.max(10,e.candidateList.length);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{variant:"h4",children:"Poll Details"}),(0,a.jsx)(r.Z,{className:e.textFieldClassName,label:"Poll Title",id:"poll-title",variant:"filled",value:e.pollName,onChange:function(t){return e.setPollName(t.target.value)}}),(0,a.jsx)(r.Z,{className:e.textFieldClassName,label:"Number of Ranked Choices",id:"ranked-choice-count",select:!0,variant:"filled",value:e.maxNumRankedChoiceCount,onChange:function(t){return e.setMaxNumRankedChoiceCount(Number(t.target.value))},children:Array(t).fill(0).map((function(e,t){return(0,a.jsx)(v.Z,{value:t+1,children:t+1},t+1)}))}),(0,a.jsx)(m,{candidateList:e.candidateList,setCandidateList:e.setCandidateList,textFieldClassName:e.textFieldClassName})]})};p.defaultProps={};var g=p},9542:function(e,t,n){"use strict";n.d(t,{Dq:function(){return s},Gm:function(){return r},Ms:function(){return i},QP:function(){return a},Qh:function(){return o},zF:function(){return c}});var a=function(e,t){return fetch("/api/v1/poll",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(t)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},i=function(e,t,n){return fetch("/api/v1/poll/".concat(t),{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(n)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},s=function(e,t){return fetch("/api/v1/poll/".concat(t),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},r=function(e,t){return fetch("/api/v1/poll/".concat(t,"/vote"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},o=function(e,t,n){return fetch("/api/v1/poll/".concat(t,"/vote"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(n)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},c=function(e,t){return fetch("/api/v1/poll/".concat(t,"/results"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))}},393:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var a=n(1799),i=n(9396),s=n(9815),r=n(7294),o=n(828),c=n(708),l=n(5934),d={data:null,messages:[],isLoading:!1,isSuccess:!1,isInitial:!0};function u(e){var t=(0,r.useState)(d),n=t[0],u=t[1],f=function(){var e=(0,o.Z)((0,c.Z)(["X-USER-ID"]),3),t=e[0],n=e[1];if(e[2],!t["X-USER-ID"]){var a=(0,l.Z)();return n("X-USER-ID",a,{path:"/"}),a}return t["X-USER-ID"]}();return[n,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return u((0,i.Z)((0,a.Z)({},d),{isLoading:!0,isInitial:!1})),e.apply(void 0,[String(f)].concat((0,s.Z)(n))).then((function(e){var t={data:e.data,messages:e.messages,isLoading:!1,isSuccess:!0,isInitial:!1};return u(t),t})).catch((function(e){var t={data:e.data,messages:e.messages,isLoading:!1,isSuccess:!1,isInitial:!1};return u(t),Promise.reject(t)}))}]}},526:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var a=n(828),i=n(5893),s=n(2741),r=n(5084),o=n(6e3),c=n(532),l=n(7294),d=n(6818),u=n(9630),f=n(1283),h=n.n(f),m=n(9542),v=n(754),p=n(9942);function g(e){var t=e.showCircle;return t?(0,i.jsx)(p.Z,{in:t,style:{transitionDelay:t?"800ms":"0ms"},unmountOnExit:!0,children:(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,i.jsx)(v.Z,{})})}):null}var x=n(393),C=n(1163),j=function(){var e,t,n=(0,C.useRouter)(),f=n.query.id,v=(0,l.useState)(""),p=v[0],j=v[1],S=(0,l.useState)(3),y=S[0],Z=S[1],k=(0,l.useState)([]),N=k[0],P=k[1],_=(0,a.Z)((0,x.i)(m.Dq),2),L=_[0],w=_[1],b=(0,a.Z)((0,x.i)(m.Ms),2),I=b[0],E=b[1],R=(0,l.useState)(null),F=R[0],D=R[1];(0,l.useEffect)((function(){n.isReady&&w(String(f))}),[n.isReady,f]),(0,l.useEffect)((function(){L.data&&(j(L.data.pollName),Z(L.data.maxNumRankedChoiceCount),P(L.data.candidateList))}),[L.data]),(0,l.useEffect)((function(){var e;L.isInitial||(L.isLoading||L.isSuccess||D({severity:"error",message:"An error has occured while loading the poll"}),(L.isLoading||L.isSuccess)&&D(null),L.isSuccess&&!(null===(e=L.data)||void 0===e?void 0:e.userIsCreator)&&D({severity:"error",message:"You are not allowed to edit a poll you did not create"}))}),[L.isInitial,L.isLoading,L.isSuccess]),(0,l.useEffect)((function(){I.isInitial||(I.isLoading||I.isSuccess||D({severity:"error",message:"An error has occured while updating the poll",errorMessages:I.messages}),(I.isLoading||I.isSuccess)&&D(null))}),[I.isInitial,I.isLoading,I.isSuccess]);var T=!L.isLoading&&(null===(e=L.data)||void 0===e?void 0:e.userIsCreator),M=!L.isLoading&&!(null===(t=L.data)||void 0===t?void 0:t.userIsCreator);return(0,i.jsxs)(o.Z,{alert:F,children:[(0,i.jsx)(u.Z,{variant:"h3",children:"Edit Poll"}),(0,i.jsx)(g,{showCircle:L.isLoading}),T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.Z,{textFieldClassName:h().candidateTextField,pollName:p,maxNumRankedChoiceCount:y,candidateList:N,setPollName:j,setMaxNumRankedChoiceCount:Z,setCandidateList:P}),(0,i.jsx)(s.Z,{style:{margin:"1rem 0",padding:"0.5rem"},severity:"warning",children:"When you update the poll, all the current votes that were made will be erased. This is to ensure all voters saw the same poll at the time of voting."}),(0,i.jsx)(r.Z,{className:h().updatePollButton,variant:"contained",startIcon:(0,i.jsx)(d.Z,{}),color:"success",onClick:function(){var e={pollName:p,maxNumRankedChoiceCount:y,candidateList:N};E(String(f),e).then((function(){var e;n.push("/vote/".concat(null===L||void 0===L||null===(e=L.data)||void 0===e?void 0:e.pollId))})).catch((function(){D({severity:"error",message:"An error has occured while updating the poll"})}))},children:"Update Poll"})]}),(0,i.jsx)(g,{showCircle:I.isLoading&&!I.isInitial}),M&&(0,i.jsx)(u.Z,{variant:"subtitle1",children:"You do not have permission to edit this Poll"})]})}},6853:function(e){e.exports={addCandidateButton:"CandidateInputList_addCandidateButton__nYhqX"}},1973:function(e){e.exports={page:"Page_page__WUVFs",contentContainer:"Page_contentContainer__BRpFP",mainContent:"Page_mainContent__Wuje1"}},1283:function(e){e.exports={textField:"_id__textField__1Xf37",candidateTextField:"_id__candidateTextField__88Uxg",updatePollButton:"_id__updatePollButton__Ivg98"}}},function(e){e.O(0,[246,419,774,888,179],(function(){return t=9127,e(e.s=t);var t}));var t=e.O();_N_E=t}]);