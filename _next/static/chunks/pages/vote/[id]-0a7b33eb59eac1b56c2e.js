(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{6165:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var i=n(7294),r=n(1002),o=n(6186),a=n(7512),s=n.n(a),c=n(5893),d=function(e){return(0,c.jsx)("div",{className:s().sidebar,children:e.children})},l=n(9035),u=n.n(l),p=function(e){var t=(0,i.useState)(!1),n=t[0],a=t[1],s=(0,i.useState)(null),d=s[0],l=s[1],p=function(){a(!1)};return(0,i.useEffect)((function(){e.alert?(l(e.alert),a(!0)):p()}),[e.alert]),(0,c.jsxs)("div",{className:u().page,children:[(0,c.jsxs)("div",{className:u().contentContainer,children:[(0,c.jsx)("div",{className:u().mainContent,children:e.children}),e.sidebar]}),(0,c.jsx)(r.Z,{open:n,onClose:p,autoHideDuration:e.autoHideAlertMilliSeconds,children:(0,c.jsx)(o.Z,{onClose:p,severity:null===d||void 0===d?void 0:d.severity,children:null===d||void 0===d?void 0:d.message})})]})};p.defaultProps={sidebar:(0,c.jsx)(d,{}),alert:null};var f=p},7392:function(e,t,n){"use strict";n.d(t,{QP:function(){return r},Ms:function(){return o},Dq:function(){return a},Qh:function(){return s},zF:function(){return c}});var i="http://localhost:8080",r=function(e,t){return fetch("/api/v1/poll",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(t)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},o=function(e,t,n){return fetch("".concat(i,"/ranked-choice-vote/v1/poll/").concat(t),{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(n)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:null,messages:[]})}))})).then((function(e){return e.json()}))},a=function(e,t){return fetch("/api/v1/poll/".concat(t),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},s=function(e,t,n){return fetch("".concat(i,"/ranked-choice-vote/v1/poll/").concat(t,"/vote"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(n)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:null,messages:[]})}))})).then((function(e){return e.json()}))},c=function(e,t){return fetch("".concat(i,"/ranked-choice-vote/v1/poll/").concat(t,"/results"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){console.log(e);return Promise.resolve({messages:[],data:{pollId:"test-do-not-deleto",pollName:"This is a test poll",totalEntries:13,totalSteps:3,maxNumRankedChoiceCount:2,winner:"spoodermann",steps:[{stepId:0,candidateList:[{name:"spoodermann",eliminated:!1,votes:[{firstChoiceCandidate:"spoodermann",voteCount:3}]},{name:"batman",eliminated:!1,votes:[{firstChoiceCandidate:"batman",voteCount:4}]},{name:"peach",eliminated:!1,votes:[{firstChoiceCandidate:"peach",voteCount:3}]},{name:"mario",eliminated:!1,votes:[{firstChoiceCandidate:"mario",voteCount:2}]},{name:"luigi",eliminated:!1,votes:[{firstChoiceCandidate:"luigi",voteCount:1}]}]},{stepId:1,candidateList:[{name:"spoodermann",eliminated:!1,votes:[{firstChoiceCandidate:"spoodermann",voteCount:3},{firstChoiceCandidate:"luigi",voteCount:1}]},{name:"batman",eliminated:!1,votes:[{firstChoiceCandidate:"batman",voteCount:4}]},{name:"peach",eliminated:!1,votes:[{firstChoiceCandidate:"peach",voteCount:3}]},{name:"mario",eliminated:!1,votes:[{firstChoiceCandidate:"mario",voteCount:2}]},{name:"luigi",eliminated:!0,votes:[{firstChoiceCandidate:"luigi",voteCount:1}]}]},{stepId:2,candidateList:[{name:"spoodermann",eliminated:!1,votes:[{firstChoiceCandidate:"spoodermann",voteCount:3},{firstChoiceCandidate:"luigi",voteCount:1},{firstChoiceCandidate:"mario",voteCount:2}]},{name:"batman",eliminated:!1,votes:[{firstChoiceCandidate:"batman",voteCount:4}]},{name:"peach",eliminated:!1,votes:[{firstChoiceCandidate:"peach",voteCount:3}]},{name:"mario",eliminated:!0,votes:[{firstChoiceCandidate:"mario",voteCount:2}]},{name:"luigi",eliminated:!0,votes:[{firstChoiceCandidate:"luigi",voteCount:1}]}]}],yourEntry:{choices:[{choicePosition:0,candidate:{name:"mario"}},{choicePosition:1,candidate:{name:"spoodermann"}}]}}})}))}},2175:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var i=n(2809),r=n(7294),o=n(318),a=n(6645),s=n(4586);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={data:null,messages:[],isLoading:!1,isSuccess:!1,isInitial:!0};function u(e){var t=(0,r.useState)(l),n=t[0],i=t[1],c=function(){var e=(0,a.Z)(["X-USER-ID"]),t=(0,o.Z)(e,3),n=t[0],i=t[1];if(t[2],!n["X-USER-ID"]){var r=(0,s.Z)();return i("X-USER-ID",r,{path:"/"}),r}return n["X-USER-ID"]}();return[n,function(){i(d(d({},l),{},{isLoading:!0,isInitial:!1}));for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[String(c)].concat(n)).then((function(e){var t={data:e.data,messages:e.messages,isLoading:!1,isSuccess:!0,isInitial:!1};return i(t),t})).catch((function(e){var t={data:e.data,messages:e.messages,isLoading:!1,isSuccess:!1,isInitial:!1};return i(t),Promise.reject(t)}))}]}},57:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var i=n(318),r=n(2809),o=n(7294),a=n(1163),s=n(2642),c=n(6165),d=n(3789),l=n(2658),u=n(5948),p=n(326),f=n(1508),h=n(1080),m=n.n(h),v=n(5893);var C=function(e){var t=e.candidateName,n={display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",background:"white",zIndex:1,width:e.width};return(0,v.jsx)("div",{style:{height:"calc(56px + 1rem)"},children:(0,v.jsxs)(f.Z,{className:m().candidateBoxSize+" "+m().centered,style:n,sx:{boxShadow:3},children:[(0,v.jsx)(l.Z,{variant:"h5",children:t}),(0,v.jsx)(p.Z,{})]})})};var j=function(e){var t=e.children,n={backgroundColor:"rgba(0, 0, 0, 0.12)",color:"rgba(0, 0, 0, 0.38)",border:"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"4px",zIndex:-1,width:e.width};return(0,v.jsx)("div",{className:m().candidateBoxSize+" "+m().centered,style:n,children:(0,v.jsx)(l.Z,{variant:"h5",children:t})})},g=n(7392),b=n(2175),y=n(6824),x=n.n(y);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(e){var t=e.pollData,n=e.setPageAlert,r=(0,b.i)(g.Qh),c=(0,i.Z)(r,2),p=(c[0],c[1]),f=(0,o.useState)([]),h=f[0],m=f[1],y=(0,o.useState)([]),O=y[0],w=y[1];(0,o.useEffect)((function(){t.candidateList&&m(t.candidateList.map((function(e){return e.name})))}),[t.candidateList]);var S={candidatesDropId:{list:h,setList:m},chosenCandidatesDropId:{list:O,setList:w}},D=function(e,t,n){var r=Array.from(e),o=r.splice(t,1),a=(0,i.Z)(o,1)[0];return r.splice(n,0,a),r},k=function(e){var i=S[e].list,r="chosenCandidatesDropId"==e&&i.length>=t.maxNumRankedChoiceCount;return r&&n({severity:"warning",message:"You can only choose a max of ".concat(t.maxNumRankedChoiceCount," candidates!")}),!r},I=function(e,t,n,r){var o=(0,d.Z)(e),a=(0,d.Z)(t),s=o.splice(n,1),c=(0,i.Z)(s,1)[0];return a.splice(r,0,c),[o,a]},_="22.5rem";return(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:"5rem"},children:[(0,v.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around"},children:(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",textAlign:"center"},children:[(0,v.jsx)(l.Z,{variant:"h2",children:t.pollName}),(0,v.jsx)(l.Z,{variant:"subtitle2",children:t.pollDesc}),(0,v.jsx)("div",{style:{height:"2rem"}}),(0,v.jsx)(l.Z,{variant:"h5",children:"Drag your selections to the ranked spots on the right."}),(0,v.jsx)("div",{style:{height:"4rem"}})]})}),(0,v.jsx)(u.Z5,{onDragEnd:function(e){var t=e.source,n=e.destination;if(n){var r=t.droppableId,o=n.droppableId;if(r===o){var a=D(S[r].list,t.index,n.index);S[r].setList(a)}else{if(!k(o))return;var s=I(S[r].list,S[o].list,t.index,n.index),c=(0,i.Z)(s,2),d=c[0],l=c[1];S[r].setList(d),S[o].setList(l)}}},children:(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:[(0,v.jsx)(u.bK,{droppableId:"candidatesDropId",children:function(e,t){return(0,v.jsxs)("div",P(P({},e.droppableProps),{},{style:{minWidth:_},ref:e.innerRef,children:[h.map((function(e,t){return(0,v.jsx)(u._l,{draggableId:e,index:t,children:function(t,n){return(0,v.jsx)("div",P(P(P({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:(0,v.jsx)(C,{candidateName:e,width:_})}))}},e)})),e.placeholder]}))}}),(0,v.jsx)("div",{style:{width:"2rem"}}),(0,v.jsx)(u.bK,{droppableId:"chosenCandidatesDropId",children:function(e,n){return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)("div",P(P({},e.droppableProps),{},{style:{minWidth:_},ref:e.innerRef,children:[(0,v.jsx)("div",{style:{position:"absolute",zIndex:-1},children:Array.from(Array(t.maxNumRankedChoiceCount).keys()).map((function(e){return(0,v.jsxs)(j,{width:_,children:["Candidate ",e+1]},e)}))}),O.map((function(e,t){return(0,v.jsx)(u._l,{draggableId:e,index:t,children:function(t,n){return(0,v.jsx)("div",P(P(P({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:(0,v.jsx)(C,{candidateName:e,width:_})}))}},e)})),e.placeholder]}))})}})]})}),(0,v.jsx)(s.Z,{variant:"contained",color:"primary",onClick:function(){if(0!=O.length){var e={choices:O.map((function(e,t){return{choicePosition:t+1,candidate:{name:e}}}))};p(t.pollId,e).then((function(){n({severity:"success",message:"Your vote was submitted!"}),a.default.push("/poll/".concat(t.pollId,"/results"))})).catch((function(){n({severity:"error",message:"Failed to submit your vote."})}))}else n({severity:"error",message:"You must choose at least 1 candidate!"})},children:"Submit Your Vote!"}),(0,v.jsx)(s.Z,{className:x().skipVoteButton,variant:"text",color:"primary",onClick:function(){a.default.push("/poll/".concat(t.pollId,"/results"))},children:"Skip to Results"})]})},S=n(266),D=n(809),k=n.n(D);var I=function(){var e=(0,o.useState)(null),t=e[0],n=e[1];return[t,function(){var e=(0,S.Z)(k().mark((function e(t){var i;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=navigator)&&void 0!==i&&i.clipboard){e.next=3;break}return console.warn("Clipboard not supported"),e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.clipboard.writeText(t);case 6:return n(t),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(3),console.warn("Copy failed",e.t0),n(null),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()]};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e){return(0,v.jsx)(s.Z,E(E({},e),{},{style:{marginBottom:"0.5rem"},children:e.children}))},N=function(e){var t=e.onShareClick,n=e.onEditClick,i=e.onCloseClick,r=e.showEditButton;return(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:"8rem",minHeight:"2rem",paddingTop:"5rem"},children:[(0,v.jsx)(Z,{variant:"contained",color:"primary",onClick:t,children:"Share"}),r&&(0,v.jsx)(Z,{variant:"outlined",onClick:n,children:"Edit Poll"}),(0,v.jsx)(Z,{variant:"outlined",onClick:i,children:"Close Poll"})]})};var R=function(){var e,t=(0,a.useRouter)(),n=(0,b.i)(g.Dq),r=(0,i.Z)(n,2),s=r[0],d=r[1],l=I(),u=(0,i.Z)(l,2),p=(u[0],u[1]);(0,o.useEffect)((function(){if(t.isReady){var e=t.query.id;d(String(e))}}),[t.isReady]);var f=(0,o.useState)(null),h=f[0],m=f[1];return(0,v.jsx)(c.Z,{alert:h,sidebar:(0,v.jsx)(N,{onShareClick:function(){var e,t;p((null===(e=window)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.href)||""),m({message:"Copied the link to your Clipboard",severity:"info"})},onEditClick:function(){var e;t.push("/updatePoll/".concat(null===s||void 0===s||null===(e=s.data)||void 0===e?void 0:e.pollId))},onCloseClick:function(){},showEditButton:(null===(e=s.data)||void 0===e?void 0:e.userIsCreator)||!1}),autoHideAlertMilliSeconds:4e3,children:s.data?(0,v.jsx)(w,{pollData:s.data,setPageAlert:m}):"Loading"})}},9521:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/[id]",function(){return n(57)}])},9035:function(e){e.exports={page:"Page_page__1hHHt",contentContainer:"Page_contentContainer__12rAS",mainContent:"Page_mainContent__GcSbW"}},7512:function(e){e.exports={sidebar:"Sidebar_sidebar__1wPFG"}},6824:function(e){e.exports={skipVoteButton:"VotePoll_skipVoteButton__2WqeT"}},1080:function(e){e.exports={candidateBoxSize:"shared_candidateBoxSize__1264_",centered:"shared_centered__TKD3A"}}},function(e){e.O(0,[630,859,649,774,888,179],(function(){return t=9521,e(e.s=t);var t}));var t=e.O();_N_E=t}]);