(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{8017:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/[id]",function(){return t(6784)}])},6e3:function(e,n,t){"use strict";var r=t(5893),i=t(7294),o=t(9243),a=t(2741),s=t(1973),c=t.n(s),d=function(e){var n=(0,i.useState)(!1),t=n[0],s=n[1],d=(0,i.useState)(null),u=d[0],l=d[1],h=function(){s(!1)};return(0,i.useEffect)((function(){e.alert?(l(e.alert),s(!0)):h()}),[e.alert]),(0,r.jsxs)("div",{className:c().page,children:[(0,r.jsxs)("div",{className:c().contentContainer,children:[(0,r.jsx)("div",{className:c().mainContent,children:e.children}),e.sidebar]}),(0,r.jsx)(o.Z,{open:t,onClose:h,autoHideDuration:e.autoHideAlertMilliSeconds,children:(0,r.jsxs)(a.Z,{onClose:h,severity:null===u||void 0===u?void 0:u.severity,children:[null===u||void 0===u?void 0:u.message,(null===u||void 0===u?void 0:u.errorMessages)&&u.errorMessages.map((function(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),e.messageContent]})}))]})})]})};d.defaultProps={alert:null},n.Z=d},9542:function(e,n,t){"use strict";t.d(n,{Dq:function(){return o},Gm:function(){return a},Ms:function(){return i},QP:function(){return r},Qh:function(){return s},zF:function(){return c}});var r=function(e,n){return fetch("/api/v1/poll",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(n)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},i=function(e,n,t){return fetch("/api/v1/poll/".concat(n),{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(t)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},o=function(e,n){return fetch("/api/v1/poll/".concat(n),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},a=function(e,n){return fetch("/api/v1/poll/".concat(n,"/vote"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},s=function(e,n,t){return fetch("/api/v1/poll/".concat(n,"/vote"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e},body:JSON.stringify(t)}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))},c=function(e,n){return fetch("/api/v1/poll/".concat(n,"/results"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json","X-USER-ID":e}}).then((function(e){return e.ok?e:e.json().then((function(e){return Promise.reject({data:e.data,messages:e.messages})}))})).then((function(e){return e.json()}))}},393:function(e,n,t){"use strict";t.d(n,{i:function(){return l}});var r=t(1799),i=t(9396),o=t(9815),a=t(7294),s=t(828),c=t(708),d=t(5934),u={data:null,messages:[],isLoading:!1,isSuccess:!1,isInitial:!0};function l(e){var n=(0,a.useState)(u),t=n[0],l=n[1],h=function(){var e=(0,s.Z)((0,c.Z)(["X-USER-ID"]),3),n=e[0],t=e[1];if(e[2],!n["X-USER-ID"]){var r=(0,d.Z)();return t("X-USER-ID",r,{path:"/"}),r}return n["X-USER-ID"]}();return[t,function(){for(var n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return l((0,i.Z)((0,r.Z)({},u),{isLoading:!0,isInitial:!1})),e.apply(void 0,[String(h)].concat((0,o.Z)(t))).then((function(e){var n={data:e.data,messages:e.messages,isLoading:!1,isSuccess:!0,isInitial:!1};return l(n),n})).catch((function(e){var n={data:e.data,messages:e.messages,isLoading:!1,isSuccess:!1,isInitial:!1};return l(n),Promise.reject(n)}))}]}},6784:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return R}});var r=t(1799),i=t(9396),o=t(828),a=t(5893),s=t(7294),c=t(1163),d=t.n(c),u=t(5084),l=t(6e3),h=t(9815),f=t(9630),p=t(5948),v=t(326),m=t(1953),x=t(108),g=t.n(x);var j=function(e){var n=e.candidateName,t={display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",background:"white",zIndex:1,width:e.width};return(0,a.jsx)("div",{style:{height:"calc(56px + 1rem)"},children:(0,a.jsxs)(m.Z,{className:g().candidateBoxSize+" "+g().centered,style:t,sx:{boxShadow:3},children:[(0,a.jsx)(f.Z,{variant:"h5",children:n}),(0,a.jsx)(v.Z,{})]})})};var y=function(e){var n=e.children,t={backgroundColor:"rgba(0, 0, 0, 0.12)",color:"rgba(0, 0, 0, 0.38)",border:"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"4px",zIndex:-1,width:e.width};return(0,a.jsx)("div",{className:g().candidateBoxSize+" "+g().centered,style:t,children:(0,a.jsx)(f.Z,{variant:"h5",children:n})})},C=t(9542),b=t(393),S=t(2027),Z=t.n(S);var w=function(e){var n=e.pollData,t=e.setPageAlert,c=(0,o.Z)((0,b.i)(C.Qh),2),l=(c[0],c[1]),v=(0,s.useState)([]),m=v[0],x=v[1],g=(0,s.useState)([]),S=g[0],w=g[1];(0,s.useEffect)((function(){n.candidateList&&x(n.candidateList.map((function(e){return e.name})))}),[n.candidateList]);var I={candidatesDropId:{list:m,setList:x},chosenCandidatesDropId:{list:S,setList:w}},k=function(e,n,t){var r=Array.from(e),i=(0,o.Z)(r.splice(n,1),1)[0];return r.splice(t,0,i),r},_=function(e){var r=I[e].list,i="chosenCandidatesDropId"==e&&r.length>=n.maxNumRankedChoiceCount;return i&&t({severity:"warning",message:"You can only choose a max of ".concat(n.maxNumRankedChoiceCount," candidates!")}),!i},P=function(e,n,t,r){var i=(0,h.Z)(e),a=(0,h.Z)(n),s=(0,o.Z)(i.splice(t,1),1)[0];return a.splice(r,0,s),[i,a]},D="22.5rem";return(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:"5rem"},children:[(0,a.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",textAlign:"center"},children:[(0,a.jsx)(f.Z,{variant:"h2",children:n.pollName}),(0,a.jsx)("div",{style:{height:"2rem"}}),(0,a.jsx)(f.Z,{variant:"h5",children:"Drag your selections to the ranked spots on the right."}),(0,a.jsx)("div",{style:{height:"4rem"}})]})}),(0,a.jsx)(p.Z5,{onDragEnd:function(e){var n=e.source,t=e.destination;if(t){var r=n.droppableId,i=t.droppableId;if(r===i){var a=k(I[r].list,n.index,t.index);I[r].setList(a)}else{if(!_(i))return;var s=(0,o.Z)(P(I[r].list,I[i].list,n.index,t.index),2),c=s[0],d=s[1];I[r].setList(c),I[i].setList(d)}}},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:[(0,a.jsx)(p.bK,{droppableId:"candidatesDropId",children:function(e,n){return(0,a.jsxs)("div",(0,i.Z)((0,r.Z)({},e.droppableProps),{style:{minWidth:D},ref:e.innerRef,children:[m.map((function(e,n){return(0,a.jsx)(p._l,{draggableId:e,index:n,children:function(n,t){return(0,a.jsx)("div",(0,i.Z)((0,r.Z)({ref:n.innerRef},n.draggableProps,n.dragHandleProps),{children:(0,a.jsx)(j,{candidateName:e,width:D})}))}},e)})),e.placeholder]}))}}),(0,a.jsx)("div",{style:{width:"2rem"}}),(0,a.jsx)(p.bK,{droppableId:"chosenCandidatesDropId",children:function(e,t){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",(0,i.Z)((0,r.Z)({},e.droppableProps),{style:{minWidth:D},ref:e.innerRef,children:[(0,a.jsx)("div",{style:{position:"absolute",zIndex:-1},children:Array.from(Array(n.maxNumRankedChoiceCount).keys()).map((function(e){return(0,a.jsxs)(y,{width:D,children:["Candidate ",e+1]},e)}))}),S.map((function(e,n){return(0,a.jsx)(p._l,{draggableId:e,index:n,children:function(n,t){return(0,a.jsx)("div",(0,i.Z)((0,r.Z)({ref:n.innerRef},n.draggableProps,n.dragHandleProps),{children:(0,a.jsx)(j,{candidateName:e,width:D})}))}},e)})),e.placeholder]}))})}})]})}),(0,a.jsx)(u.Z,{variant:"contained",color:"primary",onClick:function(){if(0!=S.length){var e={choices:S.map((function(e,n){return{choicePosition:n+1,candidate:{name:e}}}))};l(n.pollId,e).then((function(){t({severity:"success",message:"Your vote was submitted!"}),d().push("/poll/".concat(n.pollId,"/results"))})).catch((function(){t({severity:"error",message:"Failed to submit your vote."})}))}else t({severity:"error",message:"You must choose at least 1 candidate!"})},children:"Submit Your Vote!"}),(0,a.jsx)(u.Z,{className:Z().skipVoteButton,variant:"text",color:"primary",onClick:function(){d().push("/poll/".concat(n.pollId,"/results"))},children:"Skip to Results"})]})},I=t(7568),k=t(4051),_=t.n(k);var P=function(){var e=(0,s.useState)(null),n=e[0],t=e[1],r=function(){var e=(0,I.Z)(_().mark((function e(n){return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.clipboard){e.next=3;break}return console.warn("Clipboard not supported"),e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.clipboard.writeText(n);case 6:return t(n),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(3),console.warn("Copy failed",e.t0),t(null),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(n){return e.apply(this,arguments)}}();return[n,r]},D=function(e){return(0,a.jsx)(u.Z,(0,i.Z)((0,r.Z)({},e),{style:{marginBottom:"0.5rem"},children:e.children}))},E=function(e){var n=e.onShareClick,t=e.onEditClick,r=e.showEditButton;return(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:"8rem",minHeight:"2rem",paddingTop:"5rem"},children:[(0,a.jsx)(D,{variant:"contained",color:"primary",onClick:n,children:"Share"}),r&&(0,a.jsx)(D,{variant:"outlined",onClick:t,children:"Edit Poll"})]})};var R=function(){var e,n=(0,c.useRouter)(),t=(0,o.Z)((0,b.i)(C.Dq),2),r=t[0],i=t[1],d=(0,o.Z)(P(),2),u=(d[0],d[1]);(0,s.useEffect)((function(){if(n.isReady){var e=n.query.id;i(String(e))}}),[n.isReady]);var h=(0,s.useState)(null),f=h[0],p=h[1];return(0,a.jsx)(l.Z,{alert:f,sidebar:(0,a.jsx)(E,{onShareClick:function(){var e;u((null===window||void 0===window||null===(e=window.location)||void 0===e?void 0:e.href)||""),p({message:"Copied the link to your Clipboard",severity:"info"})},onEditClick:function(){var e;n.push("/updatePoll/".concat(null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.pollId))},showEditButton:(null===(e=r.data)||void 0===e?void 0:e.userIsCreator)||!1}),autoHideAlertMilliSeconds:4e3,children:r.data?(0,a.jsx)(w,{pollData:r.data,setPageAlert:p}):"Loading"})}},1973:function(e){e.exports={page:"Page_page__WUVFs",contentContainer:"Page_contentContainer__BRpFP",mainContent:"Page_mainContent__Wuje1"}},2027:function(e){e.exports={skipVoteButton:"VotePoll_skipVoteButton__3mHG7"}},108:function(e){e.exports={candidateBoxSize:"shared_candidateBoxSize__tv5GK",centered:"shared_centered__3NXpX"}}},function(e){e.O(0,[630,246,593,774,888,179],(function(){return n=8017,e(e.s=n);var n}));var n=e.O();_N_E=n}]);